package project.excel;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.apache.commons.collections.map.MultiValueMap;



public class Main {
	
	public static MultiValueMap  relX = new MultiValueMap();
	public static HashMap<String,Integer>  index_column = new HashMap<String,Integer>();
	public static ArrayList<String> elements = new ArrayList<String>();
	 //archivo preparado para la insercion de datos
	public static  String OUT_FILE= "";
	
	//archivo preparado para la extracción de datos
	public static final String IN_FILE = "C:/Users/Usuario/Desktop/datapool_plata_etiquetas.xlsx";
	
	//Elegir cual es el datapool que se quiere crear
	
	//public static final String Empeño_ = "Alhajas";
	//public static String Empeño_ = "Varios";
	//public static String Empeño_ = "Autos";
	//public static String Empeño_ = "Autos Rodando";
	//public static String Empeño_ = "Motos";
	//public static String Empeño_ = "Relojes";
	 public static String Empeño_ = "Plata";
	
	 
	

	public static void main(String[] args) throws Exception {
		// TODO Auto-generated method stub
		
		switch (Empeño_) {
		case "Alhajas":
			  Alhajas_prendario alhajas_prendario = new Alhajas_prendario();
			break;
		case "Varios":
			Varios_prendario varios_prendario = new Varios_prendario();
			break;
		case "Autos":
			  Autos_prendario autos_Prendario = new Autos_prendario();
			break;
		case "Autos Rodando":
			  AutosRodando_prendario autoRodando_prendario = new AutosRodando_prendario();
			break;
		case "Motos":
			  Motos_prendario motos_prendario = new Motos_prendario();
				break;
	    case "Relojes":
		      Relojes_prendario relojes_prendario = new Relojes_prendario();
		    	break;
	    case "Plata":
	    	  Plata_prendario plata_prendario = new Plata_prendario();
	    	break;

		default:
			break;
		} 
		  
		
		  
		  	
		  
		  
		  	
		
		  					
		  
		  		
		  
		  
		  try (FileInputStream file = new FileInputStream(new File(OUT_FILE))) {
		    	XSSFWorkbook workbook = new XSSFWorkbook (OUT_FILE); 
		    	XSSFSheet sheet = workbook.getSheetAt(0);
		    	 Iterator<Row> rowIterator = sheet.iterator();
		    	
			        for (Row row : sheet) {
			            Iterator<Cell> cellIterator = row.cellIterator();
			            if(row.getRowNum() == 0){
			            for (Cell cell : row) {
			            	
			            	try {
							String	a=cell.getStringCellValue();
							int b = cell.getColumnIndex();
							elements.add(a);
							System.out.println(a);
							index_column.put(a, b);
							} catch (Exception e) {
								// TODO Auto-generated catch block
							double	a =cell.getNumericCellValue();
							System.out.println(a);
							}   
			            }
							
			            }
			        }
		  }catch(Exception e){
			  
			  
		  }
		  
		  
		file_writer.columns =  elements.toArray();
		file_writer.file_name = "Datapool_" + Empeño_;
		file_writer.sheetName = Empeño_;
		
		file_writer writer = new file_writer();
		
		OUT_FILE =  file_writer.file_name ;
		  
		readingExcel a = new readingExcel();
		readingExcel.readingMatrix(IN_FILE,OUT_FILE);
		
	}

}
